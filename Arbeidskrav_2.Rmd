---
title: "Hei"
output:
  html_document:
    df_print: paged
---

```{r set up, echo=FALSE, include=FALSE}
library(modelr)
library(knitr)
library(ggplot2)
library(ggpubr)
library(tidyverse)
library(tinytex)
```

## Introduksjon 

Hva ulike personer tjener og hvilke yrker som tjener mest er noe vi kan lese om hver eneste dag. Vi kan også lese om forskjellene som er mellom kjønn og hva det betyr for lønnen. Hvilke andre variabler er det som kan være med på å påvirke lønnen til en person. Vi skal her se på hvilken betydning høyde har for årslønnen til en person, og skal også se på andre variabler som kan ha påvirkning på dette. 

Høyere arbeidstakere får betydelig høyere inntekt enn lavere arbeidstakere. 
Hva er, egentlig, årsak til dette fenomenet? 
Forskere er fortsatt usikkre om hvilke forhåld påvirker inntektsforskjeller mest. Noen hevder at høyere arbeidstakere har bedre kognitive evner, mens andre forskere viser til de ikke kognitive eller til de sosiale evner.
Uansett årsakssammenheng, så er lønnsforskjellen mellom høye og mindre høye arbeidstakere ganske tydelig.

## Litteraturgjennomgang 
For å katrlegge årsak til lønnsforskjeller mellom høye og mindre høye arbeidstakere, har forskerne sett på de kognitive, de ikke kognitive, de sosiale egenskaper, samt famillieforhold og muskelstyrke.

Kognitive egenskaper oppfatter mentale funksjoner som sansing, oppmerksomhet, hukommelse og logiske evner. @malt2019
Ikke kognitive egenskaper refererer til personlige egenskaper som viljestyrke, utholdenhet, karisma og lederegenskaper. Foreldrenes sosioøkonomiske egenskaper (inntekt, skolegang) samt familieforholdet (genetikk, verdier og normer) ble også vurdert som mulige årsak til ulikheter. @lundborg2014.
Deltagelse i friidrett, skoleklubber og dating hører til sosiale aktiviteter. @cinnirella2009
 
 
## Oppsummerende statistikk

```{r}
heights$heightInt <-cut(heights$height, breaks = 8)
kable(summary(heights[,1:4]))
```

```{r, echo=FALSE}
kable(summary(heights[,5:9]))
```

Denne summary funksjonen gir oss en oppsummering av undersøkelsen. Hvor det blir forklart hvor mange deltakere det er totalt i datasettet, hvilket kjønn, hvilken sivilstatus de har, utdannelse, hvilken score de fikk på "Armed Forces Qualification Test", og høyde. 

Verdiene som kommer opp i summaryen forklarer oss forskjellige aspekter av undersøkelsen. Forklaring av de måleenhetene, brukt i summaryet: 
"1st qu"= første kvartil, "3rd qu"= tredje kvartil, Median= median av den utvalgte variabelen, Mean = gjennomsnitt av variabelen, Min & Max = minste og maks verdi av en variabel. NA = Not available 
`

## Plot1

```{r echo=FALSE}
ggplot(heightsPosInc, mapping = aes(height))+
  geom_histogram(mapping = NULL,
  data = NULL,
  stat = "bin",
  position = "stack",
  binwidth = 0.5,
  bins = 30,
  na.rm = FALSE,
  orientation = NA,
  show.legend = NA,
  inherit.aes = TRUE)
```

Vi kan se på histogrammet at høyden er normalfordelt. 



## Plot1

Vi kan se på histogrammet at høyden er normalfordelt. Dette histogrammet forklarer oss hvordan utvalget i datasettet er valgt. Faktumet bak at histogrammet er normalfordelt tyder på at det er et greit variert utvalg av individer, for at datasettet ikke skal få en tydelig bias.  

```{r}
hist(heightsPosInc$income, main = "Inntekt", xlab = "$", ylab = "Antall")
```
For inntekt kan vi se at histogrammet ikke er normalfordelt. Her er majoriteten av observasjonene til venstre på x-aksen og det blir færre observasjoner desto lenger ut på x-aksen en kommer. Vi gjør dermed om inntekten til logaritmer slik at vi får et nytt histogram. Der får vi at inntekten er normalfordelt. 

```{r echo=FALSE}
heightsPosInc$logincome <- log(heightsPosInc$income)
hist(heights$logincome, main = "Inntekt", xlab = "$", ylab = "Antall")
```


## Plot2
```{r echo=FALSE}
ggplot(heightsPosInc, mapping =aes(x = height, y = income))+
    geom_point(color = "brown3")
```

```{r echo=FALSE}
ggplot(heightsPosInc, mapping =aes(x = height, y = income))+

    geom_point(color = "brown3")+
    facet_grid(~ marital)
```

```{r echo=FALSE}
ggplot(heightsPosInc, mapping =aes(x = height, y = income))+
    geom_point(color = "brown3")+
    facet_grid(~ sex)
```

Det ble regnet et gjennomsnitt av de to øverste verdiene og gjennomsnittet ble brukt til å erstatte alle verdiene i øverste siktet. Dette er sikkert personen som tjener langt over hva som er normalt å tjene. 


```{r echo=FALSE}
heightsPosInc <-subset(heights, income>0)
ggplot(heightsPosInc, mapping =aes(x = heightInt, y = income))+
    scale_y_continuous(trans = scales::log_trans())+
    geom_boxplot()
```

```{r echo=FALSE}
heightsPosInc <-subset(heights, income>0)
ggplot(heightsPosInc, mapping =aes(x = height, y = income))+
    scale_y_continuous(trans = scales::log_trans())+
    geom_point(position = "jitter")+
    geom_smooth(method = "lm")
```

```{r}
heightsPosInc <-subset(heights, income>0)
ggplot(heightsPosInc, mapping =aes(x = height, y = income))+
    geom_point(position = "jitter")+
    geom_smooth(method = MASS::rlm, se = FALSE)
```

```{r echo=FALSE}
summary(lm(income~height, data = heights))
```
 
## Konklusjon


