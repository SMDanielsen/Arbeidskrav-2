---
title: "Hei"
output:
  html_document:
    df_print: paged
---

```{r set up, echo=FALSE, include=FALSE}
library(modelr)
library(knitr)
library(ggplot2)
library(ggpubr)
library(tidyverse)
library(tinytex)
```

## Introduksjon 

Hva ulike personer tjener og hvilke yrker som tjener mest er noe vi kan lese om hver eneste dag. Vi kan også lese om forskjellene som er mellom kjønn og hva det betyr for lønnen. Hvilke andre variabler er det som kan være med på å påvirke lønnen til en person. Vi skal her se på hvilken betydning høyde har for årslønnen til en person, og skal også se på andre variabler som kan ha påvirkning på dette. 

Høyere arbeidstakere får betydelig høyere inntekt enn lavere arbeidstakere. 
Hva er, egentlig, årsak til dette fenomenet? 
Forskere er fortsatt usikkre om hvilke forhåld påvirker inntektsforskjeller mest. Noen hevder at høyere arbeidstakere har bedre kognitive evner, mens andre forskere viser til de ikke kognitive eller til de sosiale evner.
Uansett årsakssammenheng, så er lønnsforskjellen mellom høye og mindre høye arbeidstakere ganske tydelig.

## Litteraturgjennomgang 
For å katrlegge årsak til lønnsforskjeller mellom høye og mindre høye arbeidstakere, har forskerne sett på de kognitive, de ikke kognitive, de sosiale egenskaper, samt famillieforhold og muskelstyrke.

Kognitive egenskaper oppfatter mentale funksjoner som sansing, oppmerksomhet, hukommelse og logiske evner. @malt2019
Ikke kognitive egenskaper refererer til personlige egenskaper som viljestyrke, utholdenhet, karisma og lederegenskaper. Foreldrenes sosioøkonomiske egenskaper (inntekt, skolegang) samt familieforholdet (genetikk, verdier og normer) ble også vurdert som mulige årsak til ulikheter. @lundborg2014.
Deltagelse i friidrett, skoleklubber og dating hører til sosiale aktiviteter. @cinnirella2009
 
 
## Oppsummerende statistikk

```{r}
heightsPosInc <-subset(heights, income>0)
heightsPosInc$heightInt <-cut(heightsPosInc$height, breaks = 8)
```

```{r}
heights$heightInt <-cut(heights$height, breaks = 8)
kable(summary(heights[,1:4]))
```

```{r, echo=FALSE}
kable(summary(heights[,5:9]))
```

Denne summary funksjonen gir oss en oppsummering av undersøkelsen. Hvor det blir forklart hvor mange deltakere det er totalt i datasettet, hvilket kjønn, hvilken sivilstatus de har, utdannelse, hvilken score de fikk på "Armed Forces Qualification Test", og høyde. 

Verdiene som kommer opp i summaryen forklarer oss forskjellige aspekter av undersøkelsen. Forklaring av de måleenhetene, brukt i summaryet: 
"1st qu"= første kvartil, "3rd qu"= tredje kvartil, Median= median av den utvalgte variabelen, Mean = gjennomsnitt av variabelen, Min & Max = minste og maks verdi av en variabel. NA = Not available 
`

## Plot1

```{r echo=FALSE}
ggplot(heightsPosInc, mapping = aes(height)) +
  geom_histogram(mapping = NULL,
  data = NULL,
  stat = "bin",
  position = "stack",
  binwidth = 0.5,
  bins = 30,
  na.rm = FALSE,
  orientation = NA,
  show.legend = NA,
  inherit.aes = TRUE)
```

Vi kan se på histogrammet at høyden er normalfordelt. Dette tyder på at datasettet er jevnt fordelt med tanke på deltakerene involvert. Dette ser ut som en random sample av individer som fører til at undersøkelsen ikke får noen tydelig bias. 


```{r}
hist(heightsPosInc$income, main = "Inntekt", xlab = "$", ylab = "Antall")
```
For inntekt kan vi se at histogrammet ikke er normalfordelt. Her er majoriteten av observasjonene til venstre på x-aksen og det blir færre observasjoner desto lenger ut på x-aksen en kommer. Vi gjør dermed om inntekten til logaritmer slik at vi får et nytt histogram. Der får vi at inntekten er normalfordelt. 

```{r echo=FALSE}
heightsPosInc$logincome <- log(heightsPosInc$income)
hist(heightsPosInc$logincome, main = "Inntekt", xlab = "Dollar", ylab = "Antall")
```
Logaritmen som har foretatt en transformasjon, noe som fører til at grafen har blitt tilnærmet normalfordelt med noen "outliers". 

## Plot2
```{r echo=FALSE}
ggplot(heightsPosInc, mapping =aes(x = height, y = income))+
    geom_point(color = "brown3")
```

<<<<<<< HEAD
=======
 Her har vi et plot som viser til inntekten i henhold til høyden. Dette plottet viser en normalfordelt kurve. 


>>>>>>> plot2
```{r echo=FALSE}
ggplot(heightsPosInc, mapping =aes(x = height, y = income))+

    geom_point(color = "brown3")+
    facet_grid(~ marital)
```
Her har vi plottet antall individer inn i sine sivilstatuser, for å se om dette har en innvirkning på inntekten i forhold til høyde. Her kan vi se forskjellige korrelasjoner mellom sivilstatusene. separerte og enker tjener har den laveste lønnen i uansett betinget høyde. De som tjener mest er de som er gift ihenhold til plottet, samtidig som det er flest gifte i undersøkelsen.

Dette plottet støtter ikke hypotesen om at individer tjener mer på grunn av høyde. Det viser til at de kan være andre faktorer som styrer lønn enn høyde.  


```{r echo=FALSE}
ggplot(heightsPosInc, mapping =aes(x = height, y = income))+
    geom_point(color = "brown3")+
    facet_grid(~ sex)
```

Det ble regnet et gjennomsnitt av de to øverste verdiene og gjennomsnittet ble brukt til å erstatte alle verdiene i øverste siktet. Dette er sikkert personen som tjener langt over hva som er normalt å tjene. 


```{r echo=FALSE}
ggplot(heightsPosInc, mapping =aes(x = heightInt, y = income))+
    scale_y_continuous(trans = scales::log_trans())+
    geom_boxplot()
```

```{r echo=FALSE}
heightsPosInc <-subset(heights, income>0)
ggplot(heightsPosInc, mapping =aes(x = height, y = income))+
    scale_y_continuous(trans = scales::log_trans())+
    geom_point(position = "jitter")+
    geom_smooth(method = "lm")
```
Her har det blitt laget en regresjon som tar for seg inntekt og høyde. Denne viser til hvor høy korrelasjonen er mellom inntekt og høyde. Vi kan se veldig mange som er under regresjons linjen, noe som kan tyde på at det er noen som tjener ekstremt godt. Dette påvirker modellen som gjør regresjonen mindre troverdig. Gapet mellom 8103$ og 162755$ er såpass stort at det blir tvedyig og vanskelig å tolke. Det er også outliers på alle høydene fra 60-80 inches. 

```{r}
heightsPosInc <-subset(heights, income>0)
ggplot(heightsPosInc, mapping =aes(x = height, y = income))+
    geom_point(position = "jitter")+
    geom_smooth(method = MASS::rlm, se = FALSE)
```

```{r echo=FALSE}
summary(lm(income~height, data = heights))
```
  
## Konklusjon


